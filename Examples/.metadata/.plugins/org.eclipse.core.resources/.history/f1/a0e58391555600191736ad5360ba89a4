#include "user.h"

uint8_t spiData[3];
uint16_t c;
uint8_t r;
uint16_t tickCtr;

void userInit(){
	c = 0b1010101010101010;
	r = 5;
	tickCtr = 0;
}

void userLoop(){

//	if (tickCtr >= 10){
//		sendLED();
//	}

	if (tickCtr >= 10){
		//once a second
		sendLED();
//		r++;
//		if(r == 6){
//			r = 1;
//		}

		tickCtr = 0;
	}

}

void HAL_SYSTICK_Callback(void)
{
  tickCtr++;
}

void sendLED(){
	spiData[0] = (c & 0xFF00) >> 8;
	spiData[1] = c & 0x00FF;
	spiData[2] = (1 << (r-1));

	SPI_HandleTypeDef spi5 = getSPI5();

	HAL_GPIO_WritePin(GPIOB, GPIO_PIN_1, GPIO_PIN_RESET);
	HAL_SPI_Transmit(&spi5, spiData, 3, 10);
	HAL_GPIO_WritePin(GPIOB, GPIO_PIN_1, GPIO_PIN_SET);
}




